<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1251">

</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H1><A NAME="idh_tariff"></A>Тарифные планы</H1>

<P>Файл конфигурации тарифов <CODE>tariff.cfg</CODE> служит для настройки <A HREF="cfgtariff.html">модуля тарификации</A> и представляет собой описание тарифного плана, задаваемого в виде набора строк следующего формата:</P>

<PRE><CODE>Type;Direction;Number;Period;PerMinute;PerSentMB;PerReceivedMB</CODE></PRE>

<TABLE cols=2 width=622 border=2>

<TR VALIGN="top">
<TD width=20%>Type</TD>
<TD width=80%>Тип соединения: модемное, IP (соответствующие значения: <B>dial</B>, <B>ip</B>)</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>Direction</TD>
<TD width=80%>Направление соединения: входящее, исходящее, все (<B>in</B>, <B>out</B>, <B>*</B>)</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>Number</TD>
<TD width=80%>Номер телефона (IP-адреса) или его начало (например, <B>7-095-</B>, <B>192.168</B>)<BR>
В этом поле для модемных соединений указываются маски того же формата, что использует Радиус при записи в <A HREF="sdl.html">протокол модемных линий</A>. Поэтому вначале следует удостовериться в правильности маски, найдя в файле протокола модемных линий соответствующую строку набора нужного номера (например, <CODE>10-Jul-2000 17:16:59 Dialling 413230</CODE>). Для IP-соединений указывается либо полный IP-адрес, либо его начало. Не используйте маски вида <B>192.168.*</B>, достаточно
написать просто <B>192.168</B>
</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>Period</TD>
<TD width=80%>Временной интервал, в течение которого действует данный тариф<BR>
Временной интервал не должен переходить через сутки. Суточный интервал обозначается знаком <B>*</B>. Временные интервалы не должны пересекаться, в противном случае модуль тарификации произведет расчет сразу по всем пересекающимся тарифным планам. Соседние интервалы времени должны отличаться не менее (впрочем, желательно, и не более) чем на секунду, в противном случае результат расчета может оказаться неправильным. Вместо интервалов вида <B>18-0</B> следует указывать интервал <B>18-23:59:59</B></TD>
</TR>

<TR VALIGN="top">
<TD width=20%>PerMinute</TD>
<TD width=80%>Стоимость одной минуты<BR>
Стоимость задается в единицах, не привязанных к валюте. В качестве разделителя целой и дробной частей используется знак <B>,</B> (запятая)</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>PerSentMB</TD>
<TD width=80%>Стоимость переданного мегабайта</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>PerReceivedMB</TD>
<TD width=80%>Стоимость принятого мегабайта</TD>
</TR>

</TABLE>

<BR>
<P>При задании тарифных планов старайтесь не смешивать тарификацию по времени с тарификацией по траффику. Поскольку тарификация выполняется "по месту" (т.е. без хранения предыстории), нет возможности посчитать стоимость траффика, который попал одновременно в несколько тарифных диапазонов с разными расценками. Просто неизвестно, какой объем данных был принят/передан в каждом временном диапазоне. Таким образом, возможность подсчета стоимости траффика в зависимости от времени суток отсутствует (и вряд ли имеет смысл). </P>

<P>Тарифный план считывается один раз, при запуске Радиуса. Тарифы следует указывать снизу вверх от частных к самому общему.</P>

<P>В файле конфигурации тарифов допускаются строчные комментарии. В начале строки-комментария располагается знак <B>#</B>.</P>

<P>Примеры тарифов</P>
<PRE><CODE>dial;*;*;*;0;0;0
ip;*;*;*;0;0;0
dial;out;7095;0-7:59:59;5;0;0
dial;out;7095;8-17:59:59;10;0;0
dial;out;7095;18-23:59:59;7;0;0
ip;*;192.168.1;*;0;0;0
ip;out;*;0-7:59:59;7;0;0
ip;out;*;8-17:59:59;16.8;0;0
ip;out;*;18-23:59:59;14;0;0
</CODE></PRE>

<P>Пример тарифного плана</P>
<PRE><CODE># Первые два тарифа желательно использовать всегда, на случай, если какой-то 
# диапазон останется неописанным. 

# Все IP-сессии оплачиваются исходя из расценок 13 единиц за полученный 
# мегабайт. Исходящий траффик бесплатен.
ip;*;*;*;0;0;13
# Все остальные (т.е. входящие) модемные соединения бесплатны.
dial;*;*;*;0;0;0
# Звонки на все остальные номера стоят 60 единиц в минуту.
dial;out;*;*;60;0;0
# Звонки на телефонный номер 440344 бесплатны.
dial;out;440344;*;0;0;0
# Все IP-сессии с узлами 192.168 (локальная сеть) бесплатны.
ip;*;192.168;*;0;0;0
</CODE></PRE>

</BODY>
</HTML>
